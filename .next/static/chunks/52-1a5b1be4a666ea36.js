"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52],{2765:(e,t,r)=>{r.d(t,{A:()=>l,AuthProvider:()=>s});var i=r(3365),n=r(1521),a=r(8822);let o=(0,n.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[l,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[p,f]=(0,n.useState)(!0),h=(0,a.createClientComponentClient)(),m=e=>{let t={free:{daily:1,description:"1 prediction per day"},starter:{daily:3,description:"3 predictions per day"},pro:{daily:25,description:"25 predictions per day"},elite:{daily:50,description:"50 predictions per day"}};return t[e]||t.free};(0,n.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await h.auth.getSession();c(t),s(null!=(e=null==t?void 0:t.user)?e:null),(null==t?void 0:t.user)&&await y(t.user.id),f(!1)})();let{data:{subscription:e}}=h.auth.onAuthStateChange(async(e,t)=>{var r;c(t),s(null!=(r=null==t?void 0:t.user)?r:null),(null==t?void 0:t.user)?await y(t.user.id):u(null),f(!1)});return()=>e.unsubscribe()},[]);let y=async e=>{try{let{data:t,error:r}=await h.from("profiles").select("*").eq("id",e).single();if(r&&"PGRST116"===r.code)return void await _(e);if(r)return void console.error("Error loading profile:",r);let i=new Date().toISOString().split("T")[0];if(t.last_reset_date!==i){let e=m(t.subscription_tier);await E({daily_used:0,last_reset_date:i,predictions_remaining:-1===e.daily?999999:e.daily})}else u(t)}catch(e){console.error("Error in loadUserProfile:",e)}},_=async e=>{try{var t;let i=new Date().toISOString().split("T")[0],n={id:e,email:(null==r?void 0:r.email)||"",full_name:(null==r||null==(t=r.user_metadata)?void 0:t.full_name)||"User",subscription_tier:"free",predictions_remaining:3,total_predictions:0,created_at:new Date().toISOString(),daily_limit:3,daily_used:0,last_reset_date:i,disclaimer_accepted:!1,disclaimer_version:"1.0"},{data:a,error:o}=await h.from("profiles").insert([n]).select().single();if(o)return void console.error("Error creating profile:",o);u(a)}catch(e){console.error("Error in createUserProfile:",e)}},g=async(e,t)=>{try{let{error:r}=await h.auth.signInWithPassword({email:e,password:t});return{error:r}}catch(e){return{error:e}}},w=async(e,t,r)=>{try{let{error:i}=await h.auth.signUp({email:e,password:t,options:{data:{full_name:r}}});return{error:i}}catch(e){return{error:e}}},v=async()=>{try{let{error:e}=await h.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/dashboard"),queryParams:{access_type:"offline",prompt:"consent"}}});return{error:e}}catch(e){return{error:e}}},S=async()=>{try{let{error:e}=await h.auth.signInWithOAuth({provider:"apple",options:{redirectTo:"".concat(window.location.origin,"/dashboard")}});return{error:e}}catch(e){return{error:e}}},x=async()=>{await h.auth.signOut()},E=async e=>{if(r&&d)try{let{data:t,error:i}=await h.from("profiles").update(e).eq("id",r.id).select().single();if(i)return void console.error("Error updating profile:",i);u(t)}catch(e){console.error("Error in updateProfile:",e)}},P=async()=>{if(!d||!r||"elite"===d.subscription_tier)return;let e=Math.max(0,d.predictions_remaining-1),t=d.total_predictions+1,i=d.daily_used+1;await E({predictions_remaining:e,total_predictions:t,daily_used:i})},b=async e=>{d&&await E({disclaimer_accepted:!0,disclaimer_accepted_at:new Date().toISOString(),disclaimer_version:"1.0",disclaimer_initials:e})},C=async e=>{if(!d)return;let t=m(e),r=new Date().toISOString().split("T")[0];await E({subscription_tier:e,daily_limit:-1===t.daily?999999:t.daily,predictions_remaining:-1===t.daily?999999:t.daily,daily_used:0,last_reset_date:r,subscription_expires:new Date(Date.now()+2592e6).toISOString()})};return(0,i.jsx)(o.Provider,{value:{user:r,session:l,profile:d,loading:p,signIn:g,signUp:w,signInWithGoogle:v,signInWithApple:S,signOut:x,updateProfile:E,acceptDisclaimer:b,canGeneratePrediction:()=>!!d&&("elite"===d.subscription_tier||d.predictions_remaining>0),decrementPredictions:P,upgradeTier:C,getTierLimits:m},children:t})}function l(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7687:(e,t,r)=>{r.d(t,{A:()=>i});let i=(0,r(4637).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9858:(e,t,r)=>{r.d(t,{N:()=>g});var i=r(3365),n=r(1521),a=r(5894),o=r(6578),s=r(9755),l=r(5656),c=r(6084),d=r(9073);class u extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,c.s)(e)&&e.offsetWidth||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=r-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function p(e){let{children:t,isPresent:r,anchorX:a,root:o}=e,s=(0,n.useId)(),l=(0,n.useRef)(null),c=(0,n.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=(0,n.useContext)(d.Q);return(0,n.useInsertionEffect)(()=>{let{width:e,height:t,top:i,left:n,right:d}=c.current;if(r||!l.current||!e||!t)return;l.current.dataset.motionPopId=s;let u=document.createElement("style");p&&(u.nonce=p);let f=null!=o?o:document.head;return f.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===a?"left: ".concat(n):"right: ".concat(d),"px !important;\n            top: ").concat(i,"px !important;\n          }\n        ")),()=>{f.contains(u)&&f.removeChild(u)}},[r]),(0,i.jsx)(u,{isPresent:r,childRef:l,sizeRef:c,children:n.cloneElement(t,{ref:l})})}let f=e=>{let{children:t,initial:r,isPresent:a,onExitComplete:s,custom:c,presenceAffectsLayout:d,mode:u,anchorX:f,root:m}=e,y=(0,o.M)(h),_=(0,n.useId)(),g=!0,w=(0,n.useMemo)(()=>(g=!1,{id:_,initial:r,isPresent:a,custom:c,onExitComplete:e=>{for(let t of(y.set(e,!0),y.values()))if(!t)return;s&&s()},register:e=>(y.set(e,!1),()=>y.delete(e))}),[a,y,s]);return d&&g&&(w={...w}),(0,n.useMemo)(()=>{y.forEach((e,t)=>y.set(t,!1))},[a]),n.useEffect(()=>{a||y.size||!s||s()},[a]),"popLayout"===u&&(t=(0,i.jsx)(p,{isPresent:a,anchorX:f,root:m,children:t})),(0,i.jsx)(l.t.Provider,{value:w,children:t})};function h(){return new Map}var m=r(2031);let y=e=>e.key||"";function _(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}let g=e=>{let{children:t,custom:r,initial:l=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:u="sync",propagate:p=!1,anchorX:h="left",root:g}=e,[w,v]=(0,m.xQ)(p),S=(0,n.useMemo)(()=>_(t),[t]),x=p&&!w?[]:S.map(y),E=(0,n.useRef)(!0),P=(0,n.useRef)(S),b=(0,o.M)(()=>new Map),[C,I]=(0,n.useState)(S),[A,R]=(0,n.useState)(S);(0,s.E)(()=>{E.current=!1,P.current=S;for(let e=0;e<A.length;e++){let t=y(A[e]);x.includes(t)?b.delete(t):!0!==b.get(t)&&b.set(t,!1)}},[A,x.length,x.join("-")]);let M=[];if(S!==C){let e=[...S];for(let t=0;t<A.length;t++){let r=A[t],i=y(r);x.includes(i)||(e.splice(t,0,r),M.push(r))}return"wait"===u&&M.length&&(e=M),R(_(e)),I(S),null}let{forceRender:O}=(0,n.useContext)(a.L);return(0,i.jsx)(i.Fragment,{children:A.map(e=>{let t=y(e),n=(!p||!!w)&&(S===A||x.includes(t));return(0,i.jsx)(f,{isPresent:n,initial:(!E.current||!!l)&&void 0,custom:r,presenceAffectsLayout:d,mode:u,root:g,onExitComplete:n?void 0:()=>{if(!b.has(t))return;b.set(t,!0);let e=!0;b.forEach(t=>{t||(e=!1)}),e&&(null==O||O(),R(P.current),p&&(null==v||v()),c&&c())},anchorX:h,children:e},t)})})}}}]);